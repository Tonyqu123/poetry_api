{
  "openapi": "3.0.0",
  "servers": [
    {
      "description": "Poetry API Auto Mocking",
      "url": "http://poetry-api.dev.8slan.com"
    }
  ],
  "info": {
    "version": "1.0.0",
    "title": "Poetry api",
    "description": "Poetry api协议, 分页协议参考https://docs.gitlab.com/ee/api/#pagination-link-header"
  },
  "paths": {
    "/ac/analyzeSonar": {
      "parameters": [
        {
          "name": "repoId",
          "in": "query",
          "schema": {
            "type": "string"
          },
          "description": "收集指定repo的sonar质量报告"
        }
      ],
      "post": {
        "security": [
          {
            "ApiOrgTokenAuth": []
          }
        ],
        "tags": [
          "AnalysisCenter"
        ],
        "summary": "发送分析sonar指令",
        "responses": {
          "200": {
            "description": "成功获取",
            "content": {
              "text/plain": {
                "schema": {
                  "type": "string"
                }
              }
            }
          }
        }
      }
    },
    "/ac/buildDetails/search": {
      "parameters": [
        {
          "name": "reportId",
          "in": "query",
          "description": "report Id",
          "required": true,
          "schema": {
            "type": "integer"
          }
        }
      ],
      "get": {
        "security": [
          {
            "ApiKeyAuth": []
          },
          {
            "ApiRootKeyAuth": []
          }
        ],
        "tags": [
          "AnalysisCenter"
        ],
        "summary": "列出CI耗时详情",
        "responses": {
          "200": {
            "description": "报告详情",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/BuildDetail"
                  }
                }
              }
            }
          }
        }
      }
    },
    "/ac/codeCoverage/collect": {
      "post": {
        "security": [
          {
            "ApiOrgTokenAuth": []
          }
        ],
        "tags": [
          "AnalysisCenter"
        ],
        "summary": "收集覆盖率报告",
        "requestBody": {
          "description": "覆盖率报告以及其他信息",
          "content": {
            "multipart/form-data": {
              "schema": {
                "type": "object",
                "properties": {
                  "projectPath": {
                    "type": "string"
                  },
                  "namespace": {
                    "type": "string"
                  },
                  "coverage": {
                    "type": "string",
                    "format": "binary"
                  },
                  "langauge": {
                    "type": "string",
                    "enum": [
                      "java"
                    ]
                  },
                  "commitHash": {
                    "type": "string"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "分析成功",
            "content": {
              "text/plain": {
                "schema": {
                  "type": "string"
                }
              }
            }
          }
        }
      }
    },
    "/ac/codeCoverageDetails/search": {
      "parameters": [
        {
          "name": "codeCoverageId",
          "in": "query",
          "description": "CodeCoverage的ID",
          "required": true,
          "schema": {
            "type": "integer"
          }
        }
      ],
      "get": {
        "security": [
          {
            "ApiKeyAuth": []
          },
          {
            "ApiRootKeyAuth": []
          }
        ],
        "tags": [
          "AnalysisCenter"
        ],
        "summary": "列出覆盖率报告的详情",
        "responses": {
          "200": {
            "description": "覆盖率详情",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/CodeCoverageDetail"
                  }
                }
              }
            }
          }
        }
      }
    },
    "/ac/codehosts/{id}/removeRepos": {
      "parameters": [
        {
          "name": "id",
          "in": "path",
          "description": "codehost id",
          "required": true,
          "schema": {
            "type": "integer"
          }
        }
      ],
      "post": {
        "security": [
          {
            "ApiRootKeyAuth": []
          }
        ],
        "tags": [
          "AnalysisCenter"
        ],
        "summary": "删除codehost下的所有代码库",
        "responses": {
          "200": {
            "description": "删除成功",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ActionResult"
                }
              }
            }
          }
        }
      }
    },
    "/ac/codehosts/{id}/syncRepos": {
      "parameters": [
        {
          "name": "id",
          "in": "path",
          "description": "codehost id",
          "required": true,
          "schema": {
            "type": "integer"
          }
        }
      ],
      "post": {
        "security": [
          {
            "ApiKeyAuth": []
          },
          {
            "ApiRootKeyAuth": []
          }
        ],
        "tags": [
          "AnalysisCenter"
        ],
        "summary": "同步某个codehost的代码库",
        "responses": {
          "200": {
            "description": "发送同步命令成功",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ActionResult"
                }
              }
            }
          }
        }
      }
    },
    "/ac/issueMeasures/search": {
      "parameters": [
        {
          "name": "reportId",
          "in": "query",
          "description": "report id",
          "required": true,
          "schema": {
            "type": "integer"
          }
        }
      ],
      "get": {
        "security": [
          {
            "ApiKeyAuth": []
          },
          {
            "ApiRootKeyAuth": []
          }
        ],
        "tags": [
          "AnalysisCenter"
        ],
        "summary": "列出缺陷报告详情",
        "responses": {
          "200": {
            "description": "缺陷报告详情",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/IssueMeasure"
                  }
                }
              }
            }
          }
        }
      }
    },
    "/ac/measures/byOrg": {
      "parameters": [
        {
          "name": "orgId",
          "in": "query",
          "description": "组织Id",
          "required": true,
          "schema": {
            "type": "integer"
          }
        }
      ],
      "get": {
        "security": [
          {
            "ApiKeyAuth": []
          },
          {
            "ApiRootKeyAuth": []
          }
        ],
        "tags": [
          "AnalysisCenter"
        ],
        "summary": "列出组织所有团队的质效列表",
        "responses": {
          "200": {
            "description": "团队质效列表",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/TeamMeasure"
                  }
                }
              }
            }
          }
        }
      }
    },
    "/ac/measures/byTeam": {
      "parameters": [
        {
          "name": "teamId",
          "in": "query",
          "description": "团队Id",
          "required": true,
          "schema": {
            "type": "integer"
          }
        }
      ],
      "get": {
        "summary": "列出团队的代码库质效",
        "security": [
          {
            "ApiKeyAuth": []
          },
          {
            "ApiRootKeyAuth": []
          }
        ],
        "tags": [
          "AnalysisCenter"
        ],
        "responses": {
          "200": {
            "description": "代码库质效列表",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/RepoMeasure"
                  }
                }
              }
            }
          }
        }
      }
    },
    "/ac/measuresHistory/byOrg": {
      "parameters": [
        {
          "in": "query",
          "name": "orgId",
          "description": "组织Id",
          "required": true,
          "schema": {
            "type": "integer"
          }
        },
        {
          "in": "query",
          "name": "startTime",
          "description": "开始时间",
          "schema": {
            "type": "string"
          }
        },
        {
          "in": "query",
          "name": "endTime",
          "description": "结束时间",
          "schema": {
            "type": "string"
          }
        }
      ],
      "get": {
        "summary": "列出组织质效历史记录",
        "security": [
          {
            "ApiKeyAuth": []
          },
          {
            "ApiRootKeyAuth": []
          }
        ],
        "tags": [
          "AnalysisCenter"
        ],
        "responses": {
          "200": {
            "description": "组织质效历史列表",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/Measure"
                  }
                }
              }
            }
          }
        }
      }
    },
    "/ac/measuresHistory/byRepo": {
      "parameters": [
        {
          "in": "query",
          "name": "repoId",
          "description": "代码库Id",
          "required": true,
          "schema": {
            "type": "integer"
          }
        },
        {
          "in": "query",
          "name": "startTime",
          "description": "开始时间",
          "schema": {
            "type": "string"
          }
        },
        {
          "in": "query",
          "name": "endTime",
          "description": "结束时间",
          "schema": {
            "type": "string"
          }
        }
      ],
      "get": {
        "summary": "列出代码库质效历史纪录",
        "security": [
          {
            "ApiKeyAuth": []
          },
          {
            "ApiRootKeyAuth": []
          }
        ],
        "tags": [
          "AnalysisCenter"
        ],
        "responses": {
          "200": {
            "description": "代码库质效历史列表",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/Measure"
                  }
                }
              }
            }
          }
        }
      }
    },
    "/ac/measuresHistory/byTeam": {
      "parameters": [
        {
          "in": "query",
          "name": "teamId",
          "description": "团队Id",
          "required": true,
          "schema": {
            "type": "integer"
          }
        },
        {
          "in": "query",
          "name": "startTime",
          "description": "开始时间",
          "schema": {
            "type": "string"
          }
        },
        {
          "in": "query",
          "name": "endTime",
          "description": "结束时间",
          "schema": {
            "type": "string"
          }
        }
      ],
      "get": {
        "summary": "列出团队质效历史纪录",
        "security": [
          {
            "ApiKeyAuth": []
          },
          {
            "ApiRootKeyAuth": []
          }
        ],
        "tags": [
          "AnalysisCenter"
        ],
        "responses": {
          "200": {
            "description": "团队质效历史列表",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/Measure"
                  }
                }
              }
            }
          }
        }
      }
    },
    "/ac/qualityGates/query": {
      "post": {
        "security": [
          {
            "ApiOrgTokenAuth": []
          }
        ],
        "tags": [
          "AnalysisCenter"
        ],
        "summary": "获取repository设置(用于CI脚本)",
        "requestBody": {
          "description": "repository信息",
          "content": {
            "multipart/form-data": {
              "schema": {
                "type": "object",
                "properties": {
                  "projectPath": {
                    "type": "string"
                  },
                  "namespace": {
                    "type": "string"
                  },
                  "branch": {
                    "type": "string"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "成功获取sample:coverageCheck=false/true\nsonarSettings=xxxx\nrepoId=1",
            "content": {
              "text/plain": {
                "schema": {
                  "type": "string"
                }
              }
            }
          }
        }
      }
    },
    "/ac/qualityGates/update": {
      "parameters": [
        {
          "name": "teamId",
          "in": "query",
          "description": "team id",
          "schema": {
            "type": "integer"
          }
        },
        {
          "name": "repoId",
          "in": "query",
          "description": "repo id",
          "schema": {
            "type": "integer"
          }
        }
      ],
      "put": {
        "security": [
          {
            "ApiKeyAuth": []
          },
          {
            "ApiRootKeyAuth": []
          }
        ],
        "tags": [
          "AnalysisCenter"
        ],
        "summary": "更新团队/Repo质量门设置",
        "requestBody": {
          "description": "质量门设置",
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/QualityGate"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "更新结果",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ActionResult"
                }
              }
            }
          }
        }
      }
    },
    "/ac/repoNamespaces": {
      "parameters": [
        {
          "name": "codehostId",
          "in": "query",
          "description": "Codehost Id",
          "required": true,
          "schema": {
            "type": "integer"
          }
        }
      ],
      "get": {
        "security": [
          {
            "ApiKeyAuth": []
          },
          {
            "ApiRootKeyAuth": []
          }
        ],
        "tags": [
          "AnalysisCenter"
        ],
        "summary": "列出该codehost下的所有的namesapce",
        "responses": {
          "200": {
            "description": "namespace列表详情",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "type": "string"
                  }
                }
              }
            }
          }
        }
      }
    },
    "/ac/repositories/search": {
      "parameters": [
        {
          "name": "codehostId",
          "in": "query",
          "description": "codehost id",
          "required": false,
          "schema": {
            "type": "integer"
          }
        },
        {
          "name": "namespaceName",
          "in": "query",
          "description": "namespace名称",
          "required": false,
          "schema": {
            "type": "string"
          }
        }
      ],
      "get": {
        "security": [
          {
            "ApiKeyAuth": []
          },
          {
            "ApiRootKeyAuth": []
          }
        ],
        "tags": [
          "AnalysisCenter"
        ],
        "summary": "列出某个namespace下的所有Repo",
        "responses": {
          "200": {
            "description": "所有Repo详情",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/Repository"
                  }
                }
              }
            }
          }
        }
      }
    },
    "/ac/securityMeasureCount/{reportId}": {
      "parameters": [
        {
          "name": "reportId",
          "in": "path",
          "description": "report id",
          "required": true,
          "schema": {
            "type": "integer"
          }
        }
      ],
      "get": {
        "security": [
          {
            "ApiKeyAuth": []
          },
          {
            "ApiRootKeyAuth": []
          }
        ],
        "tags": [
          "AnalysisCenter"
        ],
        "summary": "列出某代码库的安全扫描个数列表",
        "responses": {
          "200": {
            "description": "安全扫描个数",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/SecurityMeasureCount"
                  }
                }
              }
            }
          }
        }
      }
    },
    "/ac/securityMeasureDetails/search": {
      "parameters": [
        {
          "name": "reportId",
          "in": "query",
          "description": "report Id",
          "required": true,
          "schema": {
            "type": "integer"
          }
        },
        {
          "name": "categorySlug",
          "in": "query",
          "description": "category slug",
          "required": true,
          "schema": {
            "type": "integer"
          }
        }
      ],
      "get": {
        "security": [
          {
            "ApiKeyAuth": []
          },
          {
            "ApiRootKeyAuth": []
          }
        ],
        "tags": [
          "AnalysisCenter"
        ],
        "summary": "列出安全扫描报告详情",
        "responses": {
          "200": {
            "description": "报告详情",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/SecurityMeasureDetail"
                  }
                }
              }
            }
          }
        }
      }
    },
    "/ac/team/{teamId}/modifyRepositories": {
      "parameters": [
        {
          "name": "teamId",
          "in": "path",
          "description": "team id",
          "required": true,
          "schema": {
            "type": "integer"
          }
        }
      ],
      "post": {
        "security": [
          {
            "ApiKeyAuth": []
          },
          {
            "ApiRootKeyAuth": []
          }
        ],
        "tags": [
          "AnalysisCenter"
        ],
        "summary": "向team添加Repo/从Team删除Repo",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "type": "array",
                "items": {
                  "$ref": "#/components/schemas/ModifyRepositoryAction"
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "更新结果",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ActionResult"
                }
              }
            }
          }
        }
      }
    },
    "/ac/team/{teamId}/removeRepos": {
      "parameters": [
        {
          "name": "teamId",
          "in": "path",
          "description": "team id",
          "required": true,
          "schema": {
            "type": "integer"
          }
        }
      ],
      "post": {
        "security": [
          {
            "ApiRootKeyAuth": []
          }
        ],
        "tags": [
          "AnalysisCenter"
        ],
        "summary": "将team下的所有repo移出该team",
        "responses": {
          "200": {
            "description": "移除结果",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ActionResult"
                }
              }
            }
          }
        }
      }
    },
    "/ac/team/{teamId}/repos": {
      "parameters": [
        {
          "name": "teamId",
          "in": "path",
          "description": "team id",
          "required": true,
          "schema": {
            "type": "integer"
          }
        }
      ],
      "get": {
        "security": [
          {
            "ApiKeyAuth": []
          },
          {
            "ApiRootKeyAuth": []
          }
        ],
        "tags": [
          "AnalysisCenter"
        ],
        "summary": "列出团队的所有Repo",
        "responses": {
          "200": {
            "description": "所有Repo详情",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/Repository"
                  }
                }
              }
            }
          }
        }
      }
    },
    "/ac/teamQualityGates/search": {
      "parameters": [
        {
          "name": "teamId",
          "in": "query",
          "description": "team id",
          "schema": {
            "type": "integer"
          }
        }
      ],
      "get": {
        "security": [
          {
            "ApiKeyAuth": []
          },
          {
            "ApiRootKeyAuth": []
          }
        ],
        "tags": [
          "AnalysisCenter"
        ],
        "summary": "获取团队质量门设置",
        "responses": {
          "200": {
            "description": "团队质量门设置",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/TeamQualityGate"
                }
              }
            }
          }
        }
      }
    },
    "/directory/ad": {
      "parameters": [
        {
          "name": "orgId",
          "in": "query",
          "description": "组织ID",
          "required": true,
          "schema": {
            "type": "integer"
          }
        }
      ],
      "post": {
        "security": [
          {
            "ApiKeyAuth": []
          },
          {
            "ApiRootKeyAuth": []
          }
        ],
        "tags": [
          "Directory"
        ],
        "summary": "创建一个新的AD配置",
        "requestBody": {
          "description": "AD配置参数",
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/Ad"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "创建成功",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Ad"
                }
              }
            }
          }
        }
      }
    },
    "/directory/ad/default": {
      "parameters": [
        {
          "name": "orgId",
          "in": "query",
          "description": "组织ID",
          "required": true,
          "schema": {
            "type": "integer"
          }
        }
      ],
      "get": {
        "security": [
          {
            "ApiKeyAuth": []
          },
          {
            "ApiRootKeyAuth": []
          }
        ],
        "tags": [
          "Directory"
        ],
        "summary": "获取企业的AD配置",
        "responses": {
          "200": {
            "description": "AD配置",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Ad"
                }
              }
            }
          }
        }
      },
      "put": {
        "tags": [
          "Directory"
        ],
        "summary": "更新企业的AD配置",
        "security": [
          {
            "ApiKeyAuth": []
          },
          {
            "ApiRootKeyAuth": []
          }
        ],
        "requestBody": {
          "description": "AD配置参数",
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/Ad"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Ad",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Ad"
                }
              }
            }
          }
        }
      },
      "delete": {
        "tags": [
          "Directory"
        ],
        "summary": "删除企业的AD配置",
        "security": [
          {
            "ApiKeyAuth": []
          },
          {
            "ApiRootKeyAuth": []
          }
        ],
        "responses": {
          "200": {
            "description": "删除成功"
          }
        }
      }
    },
    "/directory/ads/sync": {
      "parameters": [
        {
          "name": "orgId",
          "in": "query",
          "description": "组织ID",
          "required": true,
          "schema": {
            "type": "integer"
          }
        }
      ],
      "post": {
        "security": [
          {
            "ApiKeyAuth": []
          },
          {
            "ApiRootKeyAuth": []
          }
        ],
        "tags": [
          "Directory"
        ],
        "summary": "测试AD设置,根据用户输入的用户名拉取域内的所有成员",
        "responses": {
          "200": {
            "description": "测试结果",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ActionResult"
                }
              }
            }
          },
          "400": {
            "description": "错误码(resultCode):\n10002:AD connect failed\n400:username or password error\n10004:query AD user failed\n",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ActionResult"
                }
              }
            }
          }
        }
      }
    },
    "/directory/ads/test": {
      "parameters": [
        {
          "name": "orgId",
          "in": "query",
          "description": "组织ID",
          "required": true,
          "schema": {
            "type": "integer"
          }
        }
      ],
      "post": {
        "security": [
          {
            "ApiKeyAuth": []
          },
          {
            "ApiRootKeyAuth": []
          }
        ],
        "tags": [
          "Directory"
        ],
        "summary": "测试AD设置,发送联通测试和用户名密码验证",
        "responses": {
          "200": {
            "description": "测试结果",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ActionResult"
                }
              }
            }
          },
          "400": {
            "description": "错误码(resultCode):\n10002:AD connect failed\n400:username or password error\n",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ActionResult"
                }
              }
            }
          }
        }
      }
    },
    "/directory/check": {
      "get": {
        "summary": "检查系统是否初始化成功（是否有至少一个组织）",
        "tags": [
          "Directory"
        ],
        "responses": {
          "200": {
            "description": "查询成功",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "inited": {
                      "type": "boolean",
                      "description": "系统是否已初始化"
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/directory/codehosts": {
      "parameters": [
        {
          "name": "orgId",
          "in": "query",
          "description": "组织ID",
          "required": true,
          "schema": {
            "type": "integer"
          }
        }
      ],
      "post": {
        "security": [
          {
            "ApiKeyAuth": []
          },
          {
            "ApiRootKeyAuth": []
          }
        ],
        "tags": [
          "Directory"
        ],
        "summary": "创建一个新的codehost",
        "requestBody": {
          "description": "codehost 参数",
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/Codehost"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "创建成功",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Codehost"
                }
              }
            }
          }
        }
      }
    },
    "/directory/codehosts/{id}": {
      "parameters": [
        {
          "name": "id",
          "in": "path",
          "description": "codehost Id",
          "required": true,
          "schema": {
            "type": "integer"
          }
        }
      ],
      "get": {
        "tags": [
          "Directory"
        ],
        "summary": "列出codehost详情",
        "security": [
          {
            "ApiKeyAuth": []
          },
          {
            "ApiRootKeyAuth": []
          }
        ],
        "responses": {
          "200": {
            "description": "codehost详情",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Codehost"
                }
              }
            }
          }
        }
      },
      "delete": {
        "tags": [
          "Directory"
        ],
        "security": [
          {
            "ApiKeyAuth": []
          },
          {
            "ApiRootKeyAuth": []
          }
        ],
        "summary": "删除codehost",
        "responses": {
          "200": {
            "description": "删除成功k"
          }
        }
      },
      "put": {
        "tags": [
          "Directory"
        ],
        "summary": "更新codehost",
        "security": [
          {
            "ApiKeyAuth": []
          },
          {
            "ApiRootKeyAuth": []
          }
        ],
        "requestBody": {
          "description": "codehost 参数",
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/Codehost"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "更新成功",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Codehost"
                }
              }
            }
          }
        }
      }
    },
    "/directory/codehosts/callback": {
      "parameters": [
        {
          "name": "state",
          "in": "query",
          "description": "回调参数",
          "required": true,
          "schema": {
            "type": "string"
          }
        },
        {
          "name": "code",
          "in": "query",
          "description": "oauth2 code",
          "required": true,
          "schema": {
            "type": "string"
          }
        }
      ],
      "get": {
        "tags": [
          "Directory"
        ],
        "summary": "codehost授权回调",
        "responses": {
          "302": {
            "description": "授权成功"
          },
          "400": {
            "description": "授权失败, 返回失败原因. 10006:用户拒绝了授权, 10007:appid或者secret不正确，授权失败",
            "content": {
              "text/html": {
                "schema": {
                  "type": "string"
                }
              }
            }
          }
        }
      }
    },
    "/directory/codehostss/{id}/auth": {
      "parameters": [
        {
          "name": "id",
          "in": "path",
          "description": "codehost Id",
          "required": true,
          "schema": {
            "type": "integer"
          }
        },
        {
          "name": "redirect",
          "in": "query",
          "description": "授权完成后回跳地址",
          "required": true,
          "schema": {
            "type": "string"
          }
        }
      ],
      "get": {
        "security": [
          {
            "ApiKeyAuth": []
          },
          {
            "ApiRootKeyAuth": []
          }
        ],
        "tags": [
          "Directory"
        ],
        "summary": "跳转到指定codehost进行授权，授权完成后回跳到redirect地址，如成功，则传succeed=true，如失败，传errCode=someCode，errMessage=someMessage（优先使用errCode，无code用errMessage，无errMessage则界面显示未知错误）",
        "responses": {
          "302": {
            "description": "跳转"
          }
        }
      }
    },
    "/directory/codehostss/search": {
      "parameters": [
        {
          "name": "orgId",
          "in": "query",
          "description": "组织ID",
          "required": true,
          "schema": {
            "type": "integer"
          }
        },
        {
          "name": "per_page",
          "in": "query",
          "description": "分页大小",
          "schema": {
            "type": "integer"
          }
        },
        {
          "name": "page",
          "in": "query",
          "description": "分页index",
          "schema": {
            "type": "integer"
          }
        }
      ],
      "get": {
        "security": [
          {
            "ApiKeyAuth": []
          },
          {
            "ApiRootKeyAuth": []
          }
        ],
        "tags": [
          "Directory"
        ],
        "summary": "列出组织所有的codehost",
        "responses": {
          "200": {
            "description": "codehost列表",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/Codehost"
                  }
                }
              }
            }
          }
        }
      }
    },
    "/directory/emailHosts": {
      "parameters": [
        {
          "name": "orgId",
          "in": "query",
          "description": "组织ID",
          "required": true,
          "schema": {
            "type": "integer"
          }
        }
      ],
      "post": {
        "security": [
          {
            "ApiKeyAuth": []
          },
          {
            "ApiRootKeyAuth": []
          }
        ],
        "tags": [
          "Directory"
        ],
        "summary": "创建或者更新邮件主机配置",
        "requestBody": {
          "description": "邮件主机参数",
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/EmailHost"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "创建成功",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/EmailHost"
                }
              }
            }
          }
        }
      },
      "get": {
        "security": [
          {
            "ApiKeyAuth": []
          },
          {
            "ApiRootKeyAuth": []
          }
        ],
        "tags": [
          "Directory"
        ],
        "summary": "获取邮件主机配置",
        "responses": {
          "200": {
            "description": "邮件服务配置",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/EmailHost"
                }
              }
            }
          }
        }
      },
      "delete": {
        "tags": [
          "Directory"
        ],
        "summary": "删除企业的邮件主机配置",
        "security": [
          {
            "ApiKeyAuth": []
          },
          {
            "ApiRootKeyAuth": []
          }
        ],
        "responses": {
          "200": {
            "description": "删除成功"
          }
        }
      }
    },
    "/directory/emailServices": {
      "parameters": [
        {
          "name": "orgId",
          "in": "query",
          "description": "组织ID",
          "required": true,
          "schema": {
            "type": "integer"
          }
        }
      ],
      "post": {
        "security": [
          {
            "ApiKeyAuth": []
          },
          {
            "ApiRootKeyAuth": []
          }
        ],
        "tags": [
          "Directory"
        ],
        "summary": "创建或者更新邮件服务配置",
        "requestBody": {
          "description": "邮件服务参数",
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/EmailService"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "创建成功",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/EmailService"
                }
              }
            }
          }
        }
      },
      "get": {
        "security": [
          {
            "ApiKeyAuth": []
          },
          {
            "ApiRootKeyAuth": []
          }
        ],
        "tags": [
          "Directory"
        ],
        "summary": "获取邮件服务配置",
        "responses": {
          "200": {
            "description": "邮件服务配置",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/EmailService"
                }
              }
            }
          }
        }
      },
      "delete": {
        "tags": [
          "Directory"
        ],
        "summary": "删除企业的邮件服务配置",
        "security": [
          {
            "ApiKeyAuth": []
          },
          {
            "ApiRootKeyAuth": []
          }
        ],
        "responses": {
          "200": {
            "description": "删除成功"
          }
        }
      }
    },
    "/directory/emailServicess/send": {
      "parameters": [
        {
          "name": "orgId",
          "in": "query",
          "description": "组织ID",
          "required": true,
          "schema": {
            "type": "integer"
          }
        }
      ],
      "post": {
        "security": [
          {
            "ApiKeyAuth": []
          },
          {
            "ApiRootKeyAuth": []
          }
        ],
        "tags": [
          "Directory"
        ],
        "summary": "发送邮件",
        "requestBody": {
          "description": "发送邮件参数",
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "array",
                "items": {
                  "$ref": "#/components/schemas/EmailAction"
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "发送成功",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ActionResult"
                }
              }
            }
          },
          "500": {
            "description": "发送失败",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ActionResult"
                }
              }
            }
          }
        }
      }
    },
    "/directory/notifyHistorys": {
      "parameters": [
        {
          "name": "orgId",
          "in": "query",
          "description": "组织ID",
          "required": true,
          "schema": {
            "type": "integer"
          }
        }
      ],
      "get": {
        "tags": [
          "Directory"
        ],
        "security": [
          {
            "ApiKeyAuth": []
          },
          {
            "ApiRootKeyAuth": []
          }
        ],
        "summary": "列出通知历史",
        "responses": {
          "200": {
            "description": "所有通知历史",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/NotifyHistory"
                  }
                }
              }
            }
          }
        }
      }
    },
    "/directory/organization": {
      "post": {
        "tags": [
          "Directory"
        ],
        "summary": "创建一个新的组织",
        "requestBody": {
          "description": "组织注册信息",
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "name": {
                    "type": "string"
                  },
                  "website": {
                    "type": "string"
                  },
                  "adminName": {
                    "type": "string"
                  },
                  "adminEmail": {
                    "type": "string"
                  },
                  "adminPhone": {
                    "type": "string"
                  },
                  "adminPassword": {
                    "type": "string"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "创建成功",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "access_token": {
                      "type": "string",
                      "description": "admin userToken"
                    },
                    "organization": {
                      "$ref": "#/components/schemas/Organization"
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/directory/organization/{orgId}": {
      "parameters": [
        {
          "name": "orgId",
          "in": "path",
          "description": "组织ID",
          "required": true,
          "schema": {
            "type": "integer"
          }
        }
      ],
      "get": {
        "tags": [
          "Directory"
        ],
        "security": [
          {
            "ApiKeyAuth": []
          },
          {
            "ApiRootKeyAuth": []
          }
        ],
        "summary": "获取一个组织信息",
        "responses": {
          "200": {
            "description": "成功",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Organization"
                }
              }
            }
          }
        }
      },
      "put": {
        "tags": [
          "Directory"
        ],
        "summary": "更新组织信息",
        "security": [
          {
            "ApiKeyAuth": []
          },
          {
            "ApiRootKeyAuth": []
          }
        ],
        "requestBody": {
          "description": "组织信息",
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "name": {
                    "type": "string"
                  },
                  "website": {
                    "type": "string"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "成功",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Organization"
                }
              }
            }
          }
        }
      }
    },
    "/directory/organizations/findByOrgToken": {
      "parameters": [
        {
          "name": "orgToken",
          "in": "query",
          "description": "组织Token",
          "required": true,
          "schema": {
            "type": "string"
          }
        }
      ],
      "get": {
        "tags": [
          "Directory"
        ],
        "summary": "用组织Token寻找企业信息",
        "responses": {
          "200": {
            "description": "查找成功",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Organization"
                }
              }
            }
          },
          "404": {
            "description": "查找失败"
          }
        }
      }
    },
    "/directory/organizations/list": {
      "get": {
        "tags": [
          "Directory"
        ],
        "security": [
          {
            "ApiRootKeyAuth": []
          }
        ],
        "summary": "列出所有组织信息",
        "responses": {
          "200": {
            "description": "所有组织信息",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/Organization"
                  }
                }
              }
            }
          }
        }
      }
    },
    "/directory/orgToken": {
      "put": {
        "summary": "更新组织Token",
        "tags": [
          "Directory"
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "originOrgToken": {
                    "type": "string",
                    "description": "原来的组织Token"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "查找成功",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Organization"
                }
              }
            }
          },
          "404": {
            "description": "查找失败"
          }
        }
      }
    },
    "/directory/team": {
      "parameters": [
        {
          "name": "orgId",
          "in": "query",
          "description": "组织ID",
          "required": true,
          "schema": {
            "type": "integer"
          }
        }
      ],
      "post": {
        "security": [
          {
            "ApiKeyAuth": []
          },
          {
            "ApiRootKeyAuth": []
          }
        ],
        "tags": [
          "Directory"
        ],
        "summary": "创建一个新的team",
        "requestBody": {
          "description": "team参数",
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "name": {
                    "type": "string"
                  },
                  "desc": {
                    "type": "string"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "创建成功",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Team"
                }
              }
            }
          }
        }
      }
    },
    "/directory/teams/{teamId}": {
      "parameters": [
        {
          "name": "teamId",
          "in": "path",
          "description": "teamId",
          "required": true,
          "schema": {
            "type": "integer"
          }
        }
      ],
      "get": {
        "security": [
          {
            "ApiKeyAuth": []
          },
          {
            "ApiRootKeyAuth": []
          }
        ],
        "tags": [
          "Directory"
        ],
        "summary": "获取team详情",
        "responses": {
          "200": {
            "description": "获取成功",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Team"
                }
              }
            }
          }
        }
      },
      "put": {
        "security": [
          {
            "ApiKeyAuth": []
          },
          {
            "ApiRootKeyAuth": []
          }
        ],
        "tags": [
          "Directory"
        ],
        "summary": "更新team",
        "requestBody": {
          "description": "team参数",
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "name": {
                    "type": "string"
                  },
                  "desc": {
                    "type": "string"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "更新成功",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Team"
                }
              }
            }
          }
        }
      },
      "delete": {
        "security": [
          {
            "ApiKeyAuth": []
          },
          {
            "ApiRootKeyAuth": []
          }
        ],
        "tags": [
          "Directory"
        ],
        "summary": "删除team",
        "responses": {
          "200": {
            "description": "删除成功"
          }
        }
      }
    },
    "/directory/teams/{teamId}/members/batch": {
      "parameters": [
        {
          "name": "teamId",
          "in": "path",
          "description": "团队ID",
          "required": true,
          "schema": {
            "type": "integer"
          }
        }
      ],
      "post": {
        "security": [
          {
            "ApiKeyAuth": []
          },
          {
            "ApiRootKeyAuth": []
          }
        ],
        "tags": [
          "Directory"
        ],
        "summary": "更新团队成员",
        "requestBody": {
          "description": "更新团队成员数据",
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "array",
                "items": {
                  "$ref": "#/components/schemas/MemberAction"
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "更新成功",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ActionResult"
                }
              }
            }
          }
        }
      }
    },
    "/directory/teamss/search": {
      "parameters": [
        {
          "name": "orgId",
          "in": "query",
          "description": "org Id",
          "required": true,
          "schema": {
            "type": "integer"
          }
        },
        {
          "name": "keyword",
          "in": "query",
          "description": "keyword",
          "schema": {
            "type": "string"
          }
        },
        {
          "name": "per_page",
          "in": "query",
          "description": "分页大小",
          "schema": {
            "type": "integer"
          }
        },
        {
          "name": "page",
          "in": "query",
          "description": "分页index",
          "schema": {
            "type": "integer"
          }
        }
      ],
      "get": {
        "security": [
          {
            "ApiKeyAuth": []
          },
          {
            "ApiRootKeyAuth": []
          }
        ],
        "tags": [
          "Directory"
        ],
        "summary": "获取team列表",
        "responses": {
          "200": {
            "description": "获取成功",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/Team"
                  }
                }
              }
            }
          }
        }
      }
    },
    "/directory/user/{userId}": {
      "parameters": [
        {
          "name": "userId",
          "in": "path",
          "description": "user ID",
          "required": true,
          "schema": {
            "type": "integer"
          }
        }
      ],
      "delete": {
        "security": [
          {
            "ApiKeyAuth": []
          },
          {
            "ApiRootKeyAuth": []
          }
        ],
        "tags": [
          "Directory"
        ],
        "summary": "删除user",
        "responses": {
          "200": {
            "description": "删除成功"
          }
        }
      },
      "put": {
        "security": [
          {
            "ApiKeyAuth": []
          },
          {
            "ApiRootKeyAuth": []
          }
        ],
        "tags": [
          "Directory"
        ],
        "summary": "更新user",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "name": {
                    "type": "string"
                  },
                  "email": {
                    "type": "string"
                  },
                  "phone": {
                    "type": "string"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "更新成功",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/User"
                }
              }
            }
          }
        }
      }
    },
    "/directory/user/detail": {
      "get": {
        "tags": [
          "Directory"
        ],
        "security": [
          {
            "ApiKeyAuth": []
          }
        ],
        "summary": "获取user详情",
        "responses": {
          "200": {
            "description": "user详情",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "info": {
                      "$ref": "#/components/schemas/User"
                    },
                    "teams": {
                      "type": "array",
                      "items": {
                        "type": "object",
                        "properties": {
                          "id": {
                            "type": "integer"
                          },
                          "name": {
                            "type": "string",
                            "description": "团队名称"
                          },
                          "isTeamLeader": {
                            "type": "boolean"
                          }
                        }
                      }
                    },
                    "organization": {
                      "type": "object",
                      "properties": {
                        "id": {
                          "type": "integer"
                        },
                        "name": {
                          "type": "string",
                          "description": "组织名称"
                        },
                        "isAdmin": {
                          "type": "boolean"
                        }
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/directory/user/login": {
      "parameters": [
        {
          "name": "orgId",
          "in": "query",
          "description": "组织ID, 如果为空, 则只限管理员登录",
          "required": false,
          "schema": {
            "type": "integer"
          }
        }
      ],
      "post": {
        "tags": [
          "Directory"
        ],
        "summary": "用户登录",
        "requestBody": {
          "description": "email,密码",
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "email": {
                    "type": "string"
                  },
                  "password": {
                    "type": "string"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "成功",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "accessToken": {
                      "type": "string",
                      "description": "admin userToken"
                    },
                    "user": {
                      "$ref": "#/components/schemas/User"
                    },
                    "org": {
                      "type": "object",
                      "properties": {
                        "id": {
                          "type": "integer"
                        },
                        "name": {
                          "type": "string"
                        }
                      }
                    }
                  }
                }
              }
            }
          },
          "400": {
            "description": "用户名或密码错误",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ActionResult"
                }
              }
            }
          },
          "500": {
            "description": "服务不可用",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ActionResult"
                }
              }
            }
          }
        }
      }
    },
    "/directory/user/logout": {
      "post": {
        "tags": [
          "Directory"
        ],
        "summary": "退出登录（该接口由proxy实现，清除用户的客户端cookie）",
        "responses": {
          "200": {
            "description": "成功"
          }
        }
      }
    },
    "/directory/userss/search": {
      "parameters": [
        {
          "name": "orgId",
          "in": "query",
          "description": "组织ID",
          "schema": {
            "type": "integer"
          }
        },
        {
          "name": "teamId",
          "in": "query",
          "description": "team ID",
          "schema": {
            "type": "integer"
          }
        },
        {
          "name": "excludeTeamId",
          "in": "query",
          "description": "排除在指定team(id={excludeTeamId})里面的user",
          "schema": {
            "type": "integer"
          }
        },
        {
          "name": "per_page",
          "in": "query",
          "description": "分页大小",
          "schema": {
            "type": "integer"
          }
        },
        {
          "name": "page",
          "in": "query",
          "description": "分页index",
          "schema": {
            "type": "integer"
          }
        },
        {
          "name": "keyword",
          "in": "query",
          "description": "keyword",
          "schema": {
            "type": "string"
          }
        }
      ],
      "get": {
        "tags": [
          "Directory"
        ],
        "summary": "列出某组织/团队的成员, orgId和teamId必须有一个",
        "security": [
          {
            "ApiKeyAuth": []
          },
          {
            "ApiRootKeyAuth": []
          }
        ],
        "responses": {
          "200": {
            "description": "成功",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/User"
                  }
                }
              }
            }
          }
        }
      }
    },
    "/pm/buildOS": {
      "get": {
        "security": [
          {
            "ApiKeyAuth": []
          },
          {
            "ApiRootKeyAuth": []
          }
        ],
        "tags": [
          "ProjectManager"
        ],
        "summary": "获取基础构建系统列表",
        "responses": {
          "200": {
            "description": "获取成功",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/BuildOSListResponse"
                },
                "example": [
                  {
                    "name": "ubuntu:14.04",
                    "desc": "ubuntu Trusty"
                  },
                  {
                    "name": "ubuntu:16.04",
                    "desc": "ubuntu Xenial"
                  }
                ]
              }
            }
          }
        }
      }
    },
    "/pm/buildTools": {
      "parameters": [
        {
          "name": "orgId",
          "in": "query",
          "description": "org Id",
          "required": true,
          "schema": {
            "type": "integer"
          }
        }
      ],
      "get": {
        "security": [
          {
            "ApiKeyAuth": []
          },
          {
            "ApiRootKeyAuth": []
          }
        ],
        "tags": [
          "ProjectManager"
        ],
        "summary": "构建工具列表",
        "responses": {
          "200": {
            "description": "获取成功",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/BuildToolListResponse"
                },
                "example": [
                  {
                    "name": "golang",
                    "version": 1.9,
                    "desc": "golang:1.11",
                    "binPath": "/go/bin",
                    "enabled": true,
                    "scripts": "curl -fsSL http://spock-resources.qbox.net/go1.9.linux-amd64.tar.gz  -o /tmp/golang.tar.gz\ntar -C $HOME -xzf /tmp/golang.tar.gz\n",
                    "updated": "2019-01-01T12:30:00.000Z",
                    "updatedBy": "me"
                  },
                  {
                    "name": "golang",
                    "version": 1.11,
                    "desc": "golang:1.11",
                    "binPath": "/go/bin",
                    "enabled": true,
                    "scripts": "curl -fsSL http://spock-resources.qbox.net/go1.11.linux-amd64.tar.gz  -o /tmp/golang.tar.gz\ntar -C $HOME -xzf /tmp/golang.tar.gz\n",
                    "updated": "2019-02-01T12:30:00.000Z",
                    "updatedBy": "me"
                  }
                ]
              }
            }
          }
        }
      },
      "post": {
        "security": [
          {
            "ApiKeyAuth": []
          },
          {
            "ApiRootKeyAuth": []
          }
        ],
        "tags": [
          "ProjectManager"
        ],
        "summary": "添加构建工具",
        "description": "如果存在相同名称和版本号的工具，则覆盖配置",
        "requestBody": {
          "description": "添加构建工具请求",
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/BuildTool"
              },
              "examples": {
                "golang:1.11": {
                  "value": {
                    "name": "golang",
                    "version": 1.11,
                    "desc": "golang:1.11",
                    "binPath": "/go/bin",
                    "enabled": true,
                    "scripts": "curl -fsSL http://spock-resources.qbox.net/go1.11.linux-amd64.tar.gz  -o /tmp/golang.tar.gz\\n\ntar -C $HOME -xzf /tmp/golang.tar.gz\n"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "添加成功",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ActionResult"
                }
              }
            }
          }
        }
      }
    },
    "/pm/buildTools/{name}/{version}": {
      "parameters": [
        {
          "name": "orgId",
          "in": "query",
          "description": "org Id",
          "required": true,
          "schema": {
            "type": "integer"
          }
        },
        {
          "name": "name",
          "in": "path",
          "description": "工具名称",
          "required": true,
          "schema": {
            "type": "string"
          }
        },
        {
          "name": "version",
          "in": "path",
          "description": "工具版本",
          "required": true,
          "schema": {
            "type": "string"
          }
        }
      ],
      "put": {
        "security": [
          {
            "ApiKeyAuth": []
          },
          {
            "ApiRootKeyAuth": []
          }
        ],
        "tags": [
          "ProjectManager"
        ],
        "summary": "更新构建工具",
        "requestBody": {
          "description": "更新构建工具请求",
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/BuildTool"
              },
              "example": {
                "name": "golang",
                "version": 1.12,
                "desc": "golang:1.12",
                "binPath": "/go/bin",
                "enabled": true,
                "scripts": "curl -fsSL http://spock-resources.qbox.net/go1.12.linux-amd64.tar.gz  -o /tmp/golang.tar.gz\\n\ntar -C $HOME -xzf /tmp/golang.tar.gz\n"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "添加成功",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ActionResult"
                }
              }
            }
          }
        }
      },
      "delete": {
        "security": [
          {
            "ApiKeyAuth": []
          },
          {
            "ApiRootKeyAuth": []
          }
        ],
        "tags": [
          "ProjectManager"
        ],
        "summary": "删除构建工具",
        "responses": {
          "200": {
            "description": "添加成功",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ActionResult"
                }
              }
            }
          }
        }
      }
    },
    "/pm/caps": {
      "get": {
        "security": [
          {
            "ApiKeyAuth": []
          },
          {
            "ApiRootKeyAuth": []
          }
        ],
        "tags": [
          "ProjectManager"
        ],
        "summary": "运算能力列表",
        "responses": {
          "200": {
            "description": "获取成功",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/CapListResponse"
                },
                "example": [
                  {
                    "name": "high",
                    "desc": "8核16GB内存"
                  },
                  {
                    "name": "median",
                    "desc": "4核8GB内存"
                  }
                ]
              }
            }
          }
        }
      }
    },
    "/pm/envs": {
      "parameters": [
        {
          "name": "projectId",
          "in": "query",
          "description": "产品ID",
          "required": true,
          "schema": {
            "type": "integer"
          }
        }
      ],
      "post": {
        "security": [
          {
            "ApiKeyAuth": []
          },
          {
            "ApiRootKeyAuth": []
          }
        ],
        "tags": [
          "ProjectManager"
        ],
        "summary": "添加产品环境",
        "requestBody": {
          "description": "添加产品环境请求",
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/Env"
              },
              "example": {
                "name": "test",
                "desc": "测试环境，跑集成测试用",
                "forIt": true
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "添加成功",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Env"
                },
                "example": {
                  "id": 3,
                  "name": "dev",
                  "desc": "最活跃环境，经常更新，不稳定",
                  "forIt": false
                }
              }
            }
          }
        }
      },
      "get": {
        "security": [
          {
            "ApiKeyAuth": []
          },
          {
            "ApiRootKeyAuth": []
          }
        ],
        "tags": [
          "ProjectManager"
        ],
        "summary": "获取产品环境列表",
        "responses": {
          "200": {
            "description": "获取成功",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/EnvList"
                }
              }
            }
          }
        }
      }
    },
    "/pm/envs/{envId}": {
      "parameters": [
        {
          "name": "envId",
          "in": "path",
          "description": "环境ID",
          "required": true,
          "schema": {
            "type": "integer"
          }
        }
      ],
      "put": {
        "security": [
          {
            "ApiKeyAuth": []
          },
          {
            "ApiRootKeyAuth": []
          }
        ],
        "tags": [
          "ProjectManager"
        ],
        "summary": "更新产品环境",
        "requestBody": {
          "description": "更新产品环境请求",
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/Env"
              },
              "example": {
                "name": "测试",
                "desc": "测试环境",
                "forIt": true
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "更新成功",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ActionResult"
                }
              }
            }
          }
        }
      },
      "delete": {
        "security": [
          {
            "ApiKeyAuth": []
          },
          {
            "ApiRootKeyAuth": []
          }
        ],
        "tags": [
          "ProjectManager"
        ],
        "summary": "删除产品环境",
        "responses": {
          "200": {
            "description": "删除成功",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ActionResult"
                }
              }
            }
          }
        }
      }
    },
    "/pm/envs/{envId}/renderConf": {
      "parameters": [
        {
          "name": "envId",
          "in": "path",
          "description": "环境ID",
          "required": true,
          "schema": {
            "type": "integer"
          }
        }
      ],
      "post": {
        "security": [
          {
            "ApiKeyAuth": []
          },
          {
            "ApiRootKeyAuth": []
          }
        ],
        "tags": [
          "ProjectManager"
        ],
        "summary": "批量渲染服务配置",
        "responses": {
          "200": {
            "description": "渲染成功,tar.gz包,包含该环境下所有完成渲染的配置文件, 如:\n/\n  serviceA/\n    a.conf\n    deployment.yaml\n  serviceB/\n    service.yaml\n",
            "content": {
              "application/tar+gzip": {
                "schema": {
                  "type": "string",
                  "format": "binary"
                }
              }
            },
            "headers": {
              "Content-Disposition": {
                "schema": {
                  "type": "string"
                },
                "description": "文件名 ex: attachment; filename=\"filename.tar.gz\""
              },
              "Content-Type": {
                "schema": {
                  "type": "string"
                },
                "description": "application/tar+gzip"
              }
            }
          }
        }
      }
    },
    "/pm/envs/{envId}/services": {
      "parameters": [
        {
          "name": "envId",
          "in": "path",
          "description": "环境ID",
          "required": true,
          "schema": {
            "type": "integer"
          }
        }
      ],
      "get": {
        "security": [
          {
            "ApiKeyAuth": []
          },
          {
            "ApiRootKeyAuth": []
          }
        ],
        "tags": [
          "ProjectManager"
        ],
        "summary": "获取某环境下服务列表",
        "description": "artifact只显示在当前环境构建的应用包",
        "responses": {
          "200": {
            "description": "获取成功",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/EnvServiceList"
                }
              }
            }
          }
        }
      }
    },
    "/pm/envs/{envId}/vars": {
      "parameters": [
        {
          "name": "envId",
          "in": "path",
          "description": "环境ID",
          "required": true,
          "schema": {
            "type": "string"
          }
        }
      ],
      "put": {
        "security": [
          {
            "ApiKeyAuth": []
          },
          {
            "ApiRootKeyAuth": []
          }
        ],
        "tags": [
          "ProjectManager"
        ],
        "summary": "全量更新环境变量, 覆盖默认值",
        "description": "设置某个变量取默认值时，设置isDefault为TRUE\n",
        "requestBody": {
          "description": "更新环境变量请求",
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/EnvVarList"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "更新成功",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ActionResult"
                }
              }
            }
          }
        }
      },
      "get": {
        "security": [
          {
            "ApiKeyAuth": []
          },
          {
            "ApiRootKeyAuth": []
          }
        ],
        "tags": [
          "ProjectManager"
        ],
        "summary": "获取环境变量",
        "responses": {
          "200": {
            "description": "环境变量列表\n",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/EnvVarList"
                },
                "examples": {
                  "example one": {
                    "value": [
                      {
                        "key": "MYSQL_ADDR",
                        "value": "mysql://mysql:3306/me",
                        "isDefault": false,
                        "secured": false,
                        "defaultValue": "mysql://mysql:3306/foo"
                      },
                      {
                        "key": "MONGO_ADDR",
                        "value": "mongo://mongo:27017/me",
                        "isDefault": true,
                        "secured": false,
                        "defaultValue": "mongo://mongo:27017/me"
                      },
                      {
                        "key": "SUPER_KEY",
                        "value": "*******",
                        "secured": true,
                        "isDefault": false,
                        "defaultValue": "******"
                      }
                    ]
                  }
                }
              }
            }
          }
        }
      }
    },
    "/pm/jobs": {
      "parameters": [
        {
          "name": "projectId",
          "in": "query",
          "description": "产品Id",
          "required": true,
          "schema": {
            "type": "integer"
          }
        }
      ],
      "get": {
        "security": [
          {
            "ApiKeyAuth": []
          },
          {
            "ApiRootKeyAuth": []
          }
        ],
        "tags": [
          "ProjectManager"
        ],
        "summary": "获取任务列表",
        "responses": {
          "200": {
            "description": "获取成功",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/JobListResponse"
                }
              }
            }
          }
        }
      },
      "post": {
        "security": [
          {
            "ApiKeyAuth": []
          },
          {
            "ApiRootKeyAuth": []
          }
        ],
        "tags": [
          "ProjectManager"
        ],
        "summary": "新建任务",
        "requestBody": {
          "description": "添加任务请求",
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/JobUpsertRequest"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "添加成功",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Job"
                }
              }
            }
          }
        }
      }
    },
    "/pm/jobs/{jobId}": {
      "parameters": [
        {
          "name": "jobId",
          "in": "path",
          "description": "任务Id",
          "required": true,
          "schema": {
            "type": "integer"
          }
        }
      ],
      "get": {
        "security": [
          {
            "ApiKeyAuth": []
          },
          {
            "ApiRootKeyAuth": []
          }
        ],
        "tags": [
          "ProjectManager"
        ],
        "summary": "获取任务详情",
        "responses": {
          "200": {
            "description": "获取成功",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Job"
                }
              }
            }
          }
        }
      },
      "put": {
        "security": [
          {
            "ApiKeyAuth": []
          },
          {
            "ApiRootKeyAuth": []
          }
        ],
        "tags": [
          "ProjectManager"
        ],
        "summary": "更新任务",
        "requestBody": {
          "description": "更新任务请求",
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/JobUpsertRequest"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "更新成功",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ActionResult"
                }
              }
            }
          }
        }
      },
      "delete": {
        "security": [
          {
            "ApiKeyAuth": []
          },
          {
            "ApiRootKeyAuth": []
          }
        ],
        "tags": [
          "ProjectManager"
        ],
        "summary": "删除任务",
        "responses": {
          "200": {
            "description": "删除成功",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ActionResult"
                }
              }
            }
          }
        }
      }
    },
    "/pm/pipelines": {
      "parameters": [
        {
          "name": "projectId",
          "in": "query",
          "description": "产品Id",
          "required": true,
          "schema": {
            "type": "integer"
          }
        }
      ],
      "get": {
        "security": [
          {
            "ApiKeyAuth": []
          },
          {
            "ApiRootKeyAuth": []
          }
        ],
        "tags": [
          "ProjectManager"
        ],
        "summary": "获取工作流列表",
        "responses": {
          "200": {
            "description": "获取成功",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/PipelineListResponse"
                }
              }
            }
          }
        }
      },
      "post": {
        "security": [
          {
            "ApiKeyAuth": []
          },
          {
            "ApiRootKeyAuth": []
          }
        ],
        "tags": [
          "ProjectManager"
        ],
        "summary": "创建工作流",
        "requestBody": {
          "description": "添加产品请求",
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/PipelineUpsertRequest"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "创建成功",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Pipeline"
                }
              }
            }
          }
        }
      }
    },
    "/pm/pipelines/{pipeLineId}": {
      "parameters": [
        {
          "name": "pipeLineId",
          "in": "path",
          "description": "工作流Id",
          "required": true,
          "schema": {
            "type": "integer"
          }
        }
      ],
      "get": {
        "security": [
          {
            "ApiKeyAuth": []
          },
          {
            "ApiRootKeyAuth": []
          }
        ],
        "tags": [
          "ProjectManager"
        ],
        "summary": "获取工作流",
        "responses": {
          "200": {
            "description": "获取成功",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Pipeline"
                }
              }
            }
          }
        }
      },
      "put": {
        "security": [
          {
            "ApiKeyAuth": []
          },
          {
            "ApiRootKeyAuth": []
          }
        ],
        "tags": [
          "ProjectManager"
        ],
        "summary": "更新工作流",
        "requestBody": {
          "description": "更新工作流请求",
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/PipelineUpsertRequest"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "更新成功",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ActionResult"
                }
              }
            }
          }
        }
      },
      "delete": {
        "security": [
          {
            "ApiKeyAuth": []
          },
          {
            "ApiRootKeyAuth": []
          }
        ],
        "tags": [
          "ProjectManager"
        ],
        "summary": "删除工作流",
        "responses": {
          "200": {
            "description": "删除成功",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ActionResult"
                }
              }
            }
          }
        }
      }
    },
    "/pm/projects": {
      "parameters": [
        {
          "name": "orgId",
          "in": "query",
          "description": "org Id",
          "required": true,
          "schema": {
            "type": "integer"
          }
        }
      ],
      "get": {
        "security": [
          {
            "ApiKeyAuth": []
          },
          {
            "ApiRootKeyAuth": []
          }
        ],
        "tags": [
          "ProjectManager"
        ],
        "summary": "获取产品列表",
        "responses": {
          "200": {
            "description": "获取成功",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ProjectListResponse"
                },
                "example": [
                  {
                    "id": 1,
                    "name": "poetry",
                    "desc": "peotry 产品线",
                    "teams": [
                      {
                        "id": 1,
                        "name": "Poetry开发组"
                      }
                    ],
                    "releaser": [
                      {
                        "id": 2,
                        "name": "Alex"
                      },
                      {
                        "id": 3,
                        "name": "Bob"
                      }
                    ]
                  }
                ]
              }
            }
          }
        }
      },
      "post": {
        "security": [
          {
            "ApiKeyAuth": []
          },
          {
            "ApiRootKeyAuth": []
          }
        ],
        "tags": [
          "ProjectManager"
        ],
        "summary": "新建产品",
        "requestBody": {
          "description": "添加产品请求",
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/ProjectUpsertRequest"
              },
              "example": {
                "name": "poetry",
                "desc": "peotry 产品",
                "teams": [
                  1,
                  2
                ],
                "releaser": [
                  1
                ]
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "添加成功",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Project"
                }
              }
            }
          }
        }
      }
    },
    "/pm/projects/{projectId}": {
      "parameters": [
        {
          "name": "projectId",
          "in": "path",
          "description": "产品ID",
          "required": true,
          "schema": {
            "type": "string"
          }
        }
      ],
      "get": {
        "security": [
          {
            "ApiKeyAuth": []
          },
          {
            "ApiRootKeyAuth": []
          }
        ],
        "tags": [
          "ProjectManager"
        ],
        "summary": "获取产品详情",
        "responses": {
          "200": {
            "description": "获取成功",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Project"
                }
              }
            }
          }
        }
      },
      "patch": {
        "security": [
          {
            "ApiKeyAuth": []
          },
          {
            "ApiRootKeyAuth": []
          }
        ],
        "tags": [
          "ProjectManager"
        ],
        "summary": "更新产品",
        "requestBody": {
          "description": "产品参数",
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/ProjectUpsertRequest"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "更新成功",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ActionResult"
                }
              }
            }
          }
        }
      },
      "delete": {
        "security": [
          {
            "ApiKeyAuth": []
          },
          {
            "ApiRootKeyAuth": []
          }
        ],
        "tags": [
          "ProjectManager"
        ],
        "summary": "删除产品",
        "responses": {
          "200": {
            "description": "删除成功",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ActionResult"
                }
              }
            }
          }
        }
      }
    },
    "/pm/projects/{projectId}/vars": {
      "parameters": [
        {
          "name": "projectId",
          "in": "path",
          "description": "产品ID",
          "required": true,
          "schema": {
            "type": "integer"
          }
        }
      ],
      "put": {
        "security": [
          {
            "ApiKeyAuth": []
          },
          {
            "ApiRootKeyAuth": []
          }
        ],
        "tags": [
          "ProjectManager"
        ],
        "summary": "更新产品环境变量(全量)",
        "requestBody": {
          "description": "添加产品环境变量请求",
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/ProjectVarList"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "添加成功",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ActionResult"
                }
              }
            }
          }
        }
      },
      "get": {
        "security": [
          {
            "ApiKeyAuth": []
          },
          {
            "ApiRootKeyAuth": []
          }
        ],
        "tags": [
          "ProjectManager"
        ],
        "summary": "获取产品环境变量",
        "responses": {
          "200": {
            "description": "添加成功",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ProjectVarList"
                }
              }
            }
          }
        }
      }
    },
    "/pm/services": {
      "parameters": [
        {
          "name": "projectId",
          "in": "query",
          "description": "产品ID",
          "required": true,
          "schema": {
            "type": "integer"
          }
        }
      ],
      "post": {
        "security": [
          {
            "ApiKeyAuth": []
          },
          {
            "ApiRootKeyAuth": []
          }
        ],
        "tags": [
          "ProjectManager"
        ],
        "summary": "添加服务",
        "requestBody": {
          "description": "添加服务请求",
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/Service"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "添加成功",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ServiceWithConf"
                }
              }
            }
          }
        }
      },
      "get": {
        "security": [
          {
            "ApiKeyAuth": []
          },
          {
            "ApiRootKeyAuth": []
          }
        ],
        "tags": [
          "ProjectManager"
        ],
        "summary": "获取服务列表",
        "responses": {
          "200": {
            "description": "获取成功",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ServiceList"
                }
              }
            }
          }
        }
      }
    },
    "/pm/services/{serviceId}": {
      "parameters": [
        {
          "name": "serviceId",
          "in": "path",
          "description": "服务ID",
          "required": true,
          "schema": {
            "type": "integer"
          }
        }
      ],
      "put": {
        "security": [
          {
            "ApiKeyAuth": []
          },
          {
            "ApiRootKeyAuth": []
          }
        ],
        "tags": [
          "ProjectManager"
        ],
        "summary": "更新服务",
        "requestBody": {
          "description": "更新服务请求",
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/Service"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "添加成功",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ActionResult"
                }
              }
            }
          }
        }
      }
    },
    "/pm/services/{serviceId}/artifacts": {
      "parameters": [
        {
          "name": "serviceId",
          "in": "path",
          "description": "服务ID",
          "required": true,
          "schema": {
            "type": "string"
          }
        }
      ],
      "get": {
        "security": [
          {
            "ApiKeyAuth": []
          },
          {
            "ApiRootKeyAuth": []
          }
        ],
        "tags": [
          "ProjectManager"
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/page"
          },
          {
            "$ref": "#/components/parameters/per_page"
          }
        ],
        "summary": "服务的应用包列表(支持分页)",
        "responses": {
          "200": {
            "description": "获取成功",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ArtifactListResponse"
                }
              }
            },
            "headers": {
              "X-Total": {
                "$ref": "#/components/headers/X-Total"
              }
            }
          }
        }
      }
    },
    "/pm/services/{serviceId}/conf": {
      "parameters": [
        {
          "name": "serviceId",
          "in": "path",
          "description": "服务Id",
          "required": true,
          "schema": {
            "type": "integer"
          }
        }
      ],
      "put": {
        "security": [
          {
            "ApiKeyAuth": []
          },
          {
            "ApiRootKeyAuth": []
          }
        ],
        "tags": [
          "ProjectManager"
        ],
        "summary": "更新服务配置",
        "requestBody": {
          "description": "更新服务配置请求",
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/ServiceConfList"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "更新成功",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ServiceConfRevision"
                }
              }
            }
          }
        }
      },
      "get": {
        "security": [
          {
            "ApiKeyAuth": []
          },
          {
            "ApiRootKeyAuth": []
          }
        ],
        "tags": [
          "ProjectManager"
        ],
        "summary": "获取服务配置",
        "responses": {
          "200": {
            "description": "更新成功",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ServiceConfRevision"
                }
              }
            }
          }
        }
      }
    },
    "/pm/services/{serviceId}/confRestore": {
      "parameters": [
        {
          "name": "serviceId",
          "in": "path",
          "description": "服务配置ID",
          "required": true,
          "schema": {
            "type": "integer"
          }
        },
        {
          "name": "revisionId",
          "in": "query",
          "required": true,
          "schema": {
            "type": "string"
          }
        }
      ],
      "post": {
        "security": [
          {
            "ApiKeyAuth": []
          },
          {
            "ApiRootKeyAuth": []
          }
        ],
        "tags": [
          "ProjectManager"
        ],
        "summary": "还原服务配置",
        "responses": {
          "200": {
            "description": "还原结果",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ActionResult"
                }
              }
            }
          }
        }
      }
    },
    "/pm/services/{serviceId}/confRevisions": {
      "parameters": [
        {
          "name": "serviceId",
          "in": "path",
          "description": "服务ID",
          "required": true,
          "schema": {
            "type": "integer"
          }
        }
      ],
      "get": {
        "security": [
          {
            "ApiKeyAuth": []
          },
          {
            "ApiRootKeyAuth": []
          }
        ],
        "tags": [
          "ProjectManager"
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/page"
          },
          {
            "$ref": "#/components/parameters/per_page"
          }
        ],
        "summary": "服务配置历史纪录(支持分页)",
        "responses": {
          "200": {
            "description": "服务配置历史记录列表",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ServiceConfRevisionList"
                }
              }
            },
            "headers": {
              "X-Total": {
                "$ref": "#/components/headers/X-Total"
              }
            }
          }
        }
      }
    },
    "/pm/services/{serviceId}/renderAllConf": {
      "parameters": [
        {
          "name": "serviceId",
          "in": "path",
          "description": "服务配置ID",
          "required": true,
          "schema": {
            "type": "integer"
          }
        },
        {
          "name": "envName",
          "in": "query",
          "description": "环境ID",
          "required": true,
          "schema": {
            "type": "integer"
          }
        }
      ],
      "post": {
        "security": [
          {
            "ApiKeyAuth": []
          },
          {
            "ApiRootKeyAuth": []
          }
        ],
        "tags": [
          "ProjectManager"
        ],
        "summary": "渲染服务配置",
        "responses": {
          "200": {
            "description": "渲染成功,tar.gz包,包含该环境下所有完成渲染的配置文件\n/\n  a.conf\n  deployment.yaml\n",
            "content": {
              "application/tar+gzip": {
                "schema": {
                  "type": "string",
                  "format": "binary"
                }
              }
            },
            "headers": {
              "Content-Disposition": {
                "schema": {
                  "type": "string"
                },
                "description": "文件名 ex: attachment; filename=\"filename.tar.gz\""
              },
              "Content-Type": {
                "schema": {
                  "type": "string"
                },
                "description": "application/tar+gzip"
              }
            }
          }
        }
      }
    },
    "/pm/services/{serviceId}/renderConf": {
      "parameters": [
        {
          "name": "serviceId",
          "in": "path",
          "description": "服务配置ID",
          "required": true,
          "schema": {
            "type": "integer"
          }
        },
        {
          "name": "confName",
          "in": "query",
          "required": true,
          "schema": {
            "type": "string"
          }
        },
        {
          "name": "envId",
          "in": "query",
          "description": "环境ID",
          "required": true,
          "schema": {
            "type": "integer"
          }
        }
      ],
      "post": {
        "security": [
          {
            "ApiKeyAuth": []
          },
          {
            "ApiRootKeyAuth": []
          }
        ],
        "tags": [
          "ProjectManager"
        ],
        "summary": "渲染服务某个配置文件",
        "responses": {
          "200": {
            "description": "配置结果",
            "headers": {
              "Content-Disposition": {
                "schema": {
                  "type": "string"
                },
                "description": "文件名 ex: attachment; filename=\"filename.conf\""
              }
            }
          }
        }
      }
    }
  },
  "components": {
    "schemas": {
      "ActionResult": {
        "type": "object",
        "properties": {
          "resultCode": {
            "type": "integer",
            "description": "0 is good, other is bad"
          },
          "errorMsg": {
            "type": "string"
          }
        }
      },
      "Ad": {
        "type": "object",
        "properties": {
          "id": {
            "type": "integer",
            "description": "在请求体中无效"
          },
          "type": {
            "type": "string",
            "enum": [
              "ad",
              "ldap"
            ]
          },
          "address": {
            "type": "string"
          },
          "port": {
            "type": "integer"
          },
          "username": {
            "type": "string"
          },
          "password": {
            "type": "string",
            "description": "在响应体隐藏"
          },
          "dn": {
            "type": "string"
          }
        }
      },
      "Artifact": {
        "type": "object",
        "properties": {
          "id": {
            "type": "integer",
            "description": "应用包ID",
            "example": 1
          },
          "serviceName": {
            "type": "string",
            "readOnly": true,
            "description": "服务名",
            "example": "aurora-doc"
          },
          "created": {
            "type": "string",
            "readOnly": true,
            "description": "生成日期",
            "example": "2019-01-01T00:00:00.000Z"
          },
          "image": {
            "type": "string",
            "description": "镜像地址",
            "readOnly": true,
            "example": "registry.example.com/release-candidates/poetry:20180101120000-master"
          },
          "package": {
            "type": "string",
            "readOnly": true,
            "description": "应用包地址",
            "example": "/dist/release-candidates/poetry-20180101112000-master.tar.gz"
          },
          "repositories": {
            "description": "包来源",
            "type": "array",
            "readOnly": true,
            "items": {
              "$ref": "#/components/schemas/ArtifactRepository"
            }
          }
        },
        "required": [
          "id",
          "serviceName",
          "created"
        ]
      },
      "ArtifactListResponse": {
        "type": "array",
        "items": {
          "$ref": "#/components/schemas/Artifact"
        }
      },
      "ArtifactRepository": {
        "type": "object",
        "properties": {
          "addr": {
            "type": "string",
            "description": "代码库地址，",
            "example": "8slan.gitlab.com/odf/poetry"
          },
          "commit": {
            "$ref": "#/components/schemas/CodeCommit"
          },
          "pr": {
            "type": "object",
            "properties": {
              "commits": {
                "type": "array",
                "items": {
                  "$ref": "#/components/schemas/CodeCommit"
                }
              },
              "desc": {
                "type": "string",
                "description": "pr描述",
                "example": "milestone 1"
              },
              "id": {
                "type": "string",
                "example": 1
              }
            },
            "required": [
              "commits",
              "id"
            ]
          },
          "ref": {
            "type": "object",
            "properties": {
              "type": {
                "type": "string",
                "enum": [
                  "tag",
                  "branch"
                ],
                "example": "tag"
              },
              "value": {
                "type": "string",
                "description": "ref值, 如 master/v1.0.0",
                "example": "master"
              },
              "link": {
                "type": "string",
                "description": "ref http地址",
                "example": "https://gitlab.8slan.com/odf/aurora/tree/master"
              }
            }
          }
        },
        "required": [
          "addr",
          "commit",
          "ref"
        ]
      },
      "BuildDetail": {
        "type": "object",
        "properties": {
          "link": {
            "type": "string"
          },
          "succeed": {
            "type": "boolean"
          },
          "duration": {
            "type": "integer"
          },
          "time": {
            "type": "string"
          },
          "id": {
            "type": "integer"
          }
        }
      },
      "BuildOS": {
        "type": "object",
        "properties": {
          "name": {
            "type": "string",
            "example": "ubuntu:14.04"
          },
          "desc": {
            "type": "string",
            "example": "ubuntu trusty"
          }
        }
      },
      "BuildOSListResponse": {
        "type": "array",
        "items": {
          "$ref": "#/components/schemas/BuildOS"
        }
      },
      "BuildReport": {
        "type": "object",
        "properties": {
          "noBuild": {
            "type": "integer"
          },
          "noBuildSucceed": {
            "type": "integer"
          },
          "duration": {
            "type": "integer"
          },
          "time": {
            "type": "string"
          },
          "id": {
            "type": "integer"
          }
        }
      },
      "BuildTool": {
        "type": "object",
        "description": "构建工具",
        "required": [
          "name",
          "version",
          "scripts",
          "updated",
          "updatedBy"
        ],
        "properties": {
          "name": {
            "type": "string",
            "description": "工具名称如 golang",
            "example": "golang"
          },
          "version": {
            "type": "string",
            "description": "工具版本如 1.11",
            "example": 1.11
          },
          "desc": {
            "type": "string",
            "description": "工具描述",
            "example": "golang 1.11"
          },
          "binPath": {
            "type": "string",
            "description": "bin路径，构建时会被加入环境变量PATH",
            "example": "/go/bin"
          },
          "disabled": {
            "description": "默认值false",
            "type": "boolean"
          },
          "scripts": {
            "type": "string",
            "description": "安装脚本"
          },
          "updated": {
            "type": "string",
            "description": "更新时间",
            "readOnly": true,
            "example": "2019-01-01T01:01:01.123Z"
          },
          "updatedBy": {
            "type": "string",
            "description": "更新者",
            "readOnly": true,
            "example": "me"
          }
        }
      },
      "BuildToolListResponse": {
        "type": "array",
        "description": "构建工具列表",
        "items": {
          "$ref": "#/components/schemas/BuildTool"
        }
      },
      "BuildToolLite": {
        "type": "object",
        "description": "构建工具",
        "required": [
          "name",
          "version"
        ],
        "properties": {
          "name": {
            "type": "string",
            "description": "工具名称如 golang",
            "example": "golang"
          },
          "version": {
            "type": "string",
            "description": "工具版本如 1.11",
            "example": 1.11
          },
          "desc": {
            "type": "string",
            "description": "工具描述",
            "example": "golang 1.11",
            "readOnly": true
          }
        }
      },
      "Cap": {
        "type": "object",
        "description": "运算能力",
        "properties": {
          "name": {
            "type": "string",
            "enum": [
              "high",
              "median",
              "low",
              "tiny"
            ]
          },
          "desc": {
            "type": "string",
            "description": "CPU和内存配置,\n如\n  high: 8核 16G内存\n  medium: 4核 8G内存\n  low: 2核 4G内存\n  tiny: 1核 4G内存\n"
          }
        },
        "required": [
          "name",
          "desc"
        ]
      },
      "CapListResponse": {
        "type": "array",
        "description": "运算能力列表",
        "items": {
          "$ref": "#/components/schemas/Cap"
        }
      },
      "CodeCommit": {
        "type": "object",
        "description": "commit信息",
        "properties": {
          "hash": {
            "type": "string",
            "example": "ac3cda2"
          },
          "comment": {
            "type": "string",
            "example": "fix issue#123"
          }
        }
      },
      "CodeCoverage": {
        "type": "object",
        "properties": {
          "noStmt": {
            "type": "integer"
          },
          "noMissedStmt": {
            "type": "integer"
          },
          "noLine": {
            "type": "integer"
          },
          "noMissedLine": {
            "type": "integer"
          },
          "time": {
            "type": "string"
          },
          "id": {
            "type": "integer"
          }
        }
      },
      "CodeCoverageDetail": {
        "type": "object",
        "properties": {
          "packageName": {
            "type": "string"
          },
          "noStmt": {
            "type": "integer"
          },
          "noMissedStmt": {
            "type": "integer"
          }
        }
      },
      "Codehost": {
        "type": "object",
        "properties": {
          "id": {
            "type": "integer",
            "description": "请求体中无效"
          },
          "orgId": {
            "type": "string",
            "description": "组织ID"
          },
          "name": {
            "type": "string"
          },
          "type": {
            "type": "string",
            "enum": [
              "gitlab"
            ]
          },
          "address": {
            "type": "string",
            "description": "gitlab地址"
          },
          "ready": {
            "type": "boolean",
            "description": "是否已经授权完毕"
          },
          "accessToken": {
            "type": "string",
            "description": "请求体中无效"
          },
          "refreshToken": {
            "type": "string",
            "description": "请求体中无效"
          },
          "namespace": {
            "type": "string",
            "description": "代码库的命名空间(对应gitlab里的user或者group)"
          },
          "applicationId": {
            "type": "string"
          },
          "clientSecret": {
            "type": "string"
          }
        }
      },
      "EmailAction": {
        "type": "object",
        "properties": {
          "email": {
            "type": "string"
          }
        }
      },
      "EmailHost": {
        "type": "object",
        "properties": {
          "id": {
            "type": "integer",
            "description": "在请求体中无效"
          },
          "name": {
            "type": "string"
          },
          "port": {
            "type": "integer"
          },
          "username": {
            "type": "string"
          },
          "password": {
            "type": "string",
            "description": "在响应体隐藏"
          },
          "isTlS": {
            "type": "boolean"
          }
        }
      },
      "EmailService": {
        "type": "object",
        "properties": {
          "id": {
            "type": "integer",
            "description": "在请求体中无效"
          },
          "name": {
            "type": "string"
          },
          "address": {
            "type": "string"
          },
          "displayName": {
            "type": "string"
          },
          "theme": {
            "type": "string"
          }
        }
      },
      "Env": {
        "type": "object",
        "properties": {
          "id": {
            "type": "integer",
            "description": "环境唯一ID (在更新，添加方法的请求体中无效)",
            "readOnly": true,
            "example": 1
          },
          "name": {
            "type": "string",
            "description": "环境名称",
            "example": "dev"
          },
          "desc": {
            "type": "string",
            "description": "环境描述",
            "example": "dev环境"
          },
          "forIt": {
            "type": "boolean",
            "description": "是否集成测试环境, 默认值 false",
            "example": false
          }
        },
        "required": [
          "id",
          "name",
          "desc",
          "forIt"
        ]
      },
      "EnvList": {
        "type": "array",
        "items": {
          "$ref": "#/components/schemas/Env"
        }
      },
      "EnvService": {
        "allOf": [
          {
            "$ref": "#/components/schemas/ServiceWithConfLite"
          },
          {
            "type": "object",
            "properties": {
              "artifact": {
                "$ref": "#/components/schemas/Artifact"
              }
            }
          }
        ],
        "required": [
          "id",
          "name",
          "conf",
          "artifact"
        ]
      },
      "EnvServiceList": {
        "type": "array",
        "items": {
          "$ref": "#/components/schemas/EnvService"
        }
      },
      "EnvVar": {
        "type": "object",
        "description": "环境参数",
        "properties": {
          "key": {
            "type": "string",
            "description": "变量名称",
            "pattern": "[a-z0-9A-Z_\\.\\-]+",
            "example": "MYSQL_ADDR"
          },
          "value": {
            "type": "string",
            "description": "值",
            "example": "mysql://mysql:3306/you"
          },
          "isDefault": {
            "type": "boolean",
            "description": "是否默认值",
            "example": false
          },
          "defaultValue": {
            "type": "string",
            "description": "默认值",
            "readOnly": true,
            "example": "mysql://mysql:3306/me"
          },
          "secured": {
            "type": "boolean",
            "description": "是否加密值",
            "readOnly": true,
            "example": true
          }
        },
        "required": [
          "key",
          "value",
          "isDefault",
          "secured"
        ]
      },
      "EnvVarList": {
        "type": "array",
        "items": {
          "$ref": "#/components/schemas/EnvVar"
        }
      },
      "IssueMeasure": {
        "type": "object",
        "properties": {
          "file": {
            "type": "string"
          },
          "line": {
            "type": "integer"
          },
          "description": {
            "type": "string"
          }
        }
      },
      "IssueReport": {
        "type": "object",
        "properties": {
          "noIssue": {
            "type": "integer"
          },
          "time": {
            "type": "string"
          },
          "id": {
            "type": "integer"
          }
        }
      },
      "Job": {
        "type": "object",
        "properties": {
          "id": {
            "type": "integer",
            "description": "任务ID",
            "example": 1
          },
          "name": {
            "type": "string",
            "description": "任务名称",
            "example": "aurora构建任务"
          },
          "desc": {
            "type": "string",
            "description": "任务描述",
            "example": "aurora"
          },
          "type": {
            "$ref": "#/components/schemas/JobType"
          },
          "services": {
            "type": "array",
            "description": "关联的service",
            "items": {
              "type": "object",
              "properties": {
                "id": {
                  "type": "integer",
                  "description": "服务ID",
                  "example": 1
                },
                "name": {
                  "type": "string",
                  "description": "服务名称",
                  "example": "aurora-doc"
                }
              }
            }
          },
          "timeout": {
            "type": "integer",
            "description": "超时时间(秒)",
            "example": 60
          },
          "runtime": {
            "$ref": "#/components/schemas/JobRuntime"
          },
          "vars": {
            "$ref": "#/components/schemas/JobVars"
          },
          "buildConf": {
            "$ref": "#/components/schemas/JobBuildConf"
          },
          "deployConf": {
            "$ref": "#/components/schemas/JobDeployConf"
          },
          "testConf": {
            "$ref": "#/components/schemas/JobTestConf"
          }
        },
        "required": [
          "id",
          "name",
          "type",
          "services",
          "timeout"
        ]
      },
      "JobBuildConf": {
        "type": "object",
        "description": "构建任务配置",
        "properties": {
          "caches": {
            "type": "array",
            "items": {
              "type": "string",
              "example": "./cache"
            }
          },
          "scripts": {
            "description": "运行脚本",
            "type": "array",
            "items": {
              "type": "string",
              "example": "echo \"hello world\""
            }
          },
          "repositories": {
            "type": "array",
            "items": {
              "type": "object",
              "description": "代码库",
              "properties": {
                "codehost": {
                  "type": "object",
                  "properties": {
                    "id": {
                      "type": "integer",
                      "description": "代码库ID",
                      "example": 1
                    },
                    "address": {
                      "type": "string",
                      "description": "代码库地址",
                      "readOnly": true,
                      "example": "gitlab.8slan.com"
                    },
                    "type": {
                      "type": "string",
                      "enum": [
                        "gitlab",
                        "github"
                      ],
                      "readOnly": true,
                      "example": "gitlab"
                    }
                  }
                },
                "namespace": {
                  "type": "string",
                  "description": "命名空间 (user/group)",
                  "example": "odf"
                },
                "name": {
                  "type": "string",
                  "description": "代码库名称",
                  "example": "poetry"
                },
                "branch": {
                  "type": "string",
                  "description": "分支名",
                  "example": "master"
                },
                "submodule": {
                  "type": "boolean",
                  "description": "是否同步子模块",
                  "example": false
                }
              },
              "required": [
                "codehost",
                "namespace",
                "name"
              ]
            }
          }
        },
        "required": [
          "caches",
          "scripts",
          "packaging",
          "repositories"
        ]
      },
      "JobDeployConf": {
        "type": "object",
        "description": "部署配置",
        "properties": {
          "containerized": {
            "type": "boolean",
            "description": "容器化部署"
          },
          "scripts": {
            "description": "运行脚本 (仅当containerized=false时有效)",
            "type": "array",
            "items": {
              "type": "string"
            }
          },
          "useLatestArtifact": {
            "type": "boolean",
            "description": "使用最新的应用包 (仅当containerized=false时有效)"
          },
          "artifact": {
            "$ref": "#/components/schemas/Artifact",
            "description": "仅当useLatestArtifact=false时有效 (仅当containerized=false时有效)"
          }
        },
        "required": [
          "containerized",
          "scripts",
          "useLatestArtifact"
        ]
      },
      "JobListResponse": {
        "type": "array",
        "items": {
          "$ref": "#/components/schemas/Job"
        }
      },
      "JobRuntime": {
        "type": "object",
        "properties": {
          "os": {
            "type": "string",
            "description": "运行os，如 ubuntu:14.04, ubuntu:16.04",
            "example": "ubuntu:14.04"
          },
          "cap": {
            "type": "string",
            "enum": [
              "high",
              "median",
              "low",
              "tiny"
            ],
            "example": "high"
          },
          "buildTools": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/BuildToolLite"
            }
          }
        }
      },
      "JobTestConf": {
        "type": "object",
        "description": "测试任务配置",
        "properties": {
          "threshold": {
            "type": "number",
            "description": "测试通过率阈值",
            "example": 40.5
          },
          "reportLocation": {
            "type": "array",
            "description": "测试结果路径",
            "items": {
              "type": "string"
            },
            "example": [
              "./reports/report.xml",
              "./reports/it/*.jacoco"
            ]
          }
        },
        "required": [
          "threshold",
          "reportLocation"
        ]
      },
      "JobType": {
        "type": "string",
        "enum": [
          "test",
          "build",
          "deploy"
        ],
        "description": "任务类型",
        "example": "build"
      },
      "JobUpsertRequest": {
        "type": "object",
        "description": "测试任务需要包含buildConf和testConf",
        "properties": {
          "name": {
            "type": "string",
            "example": "Poetry构建任务"
          },
          "type": {
            "$ref": "#/components/schemas/JobType"
          },
          "services": {
            "type": "array",
            "items": {
              "type": "object",
              "properties": {
                "id": {
                  "type": "integer",
                  "description": "服务ID"
                }
              }
            }
          },
          "timeout": {
            "type": "integer",
            "description": "超时时间(秒)"
          },
          "runtime": {
            "$ref": "#/components/schemas/JobRuntime"
          },
          "vars": {
            "$ref": "#/components/schemas/JobVars"
          },
          "buildConf": {
            "$ref": "#/components/schemas/JobBuildConf"
          },
          "deployConf": {
            "$ref": "#/components/schemas/JobDeployConf"
          },
          "testConf": {
            "$ref": "#/components/schemas/JobTestConf"
          }
        },
        "required": [
          "name",
          "type",
          "services",
          "timeout",
          "vars"
        ]
      },
      "JobVars": {
        "description": "自定义变量",
        "type": "array",
        "items": {
          "type": "object",
          "properties": {
            "key": {
              "type": "string",
              "description": "变量名称",
              "pattern": "[a-z0-9A-Z_\\-\\.]+",
              "example": "HTTP_PROXY"
            },
            "value": {
              "type": "string",
              "description": "值",
              "example": "http://10.0.0.1:3128"
            },
            "secured": {
              "type": "boolean",
              "description": "是否敏感信息",
              "example": true
            }
          }
        },
        "required": [
          "key",
          "value",
          "secured"
        ]
      },
      "Measure": {
        "type": "object",
        "properties": {
          "codeCoverage": {
            "$ref": "#/components/schemas/CodeCoverage"
          },
          "securityReport": {
            "$ref": "#/components/schemas/SecurityReport"
          },
          "issueReport": {
            "$ref": "#/components/schemas/IssueReport"
          },
          "buildReport": {
            "$ref": "#/components/schemas/BuildReport"
          }
        }
      },
      "MemberAction": {
        "type": "object",
        "properties": {
          "id": {
            "type": "integer",
            "description": "user id"
          },
          "action": {
            "type": "string",
            "enum": [
              "add",
              "remove",
              "update"
            ]
          },
          "isTeamleader": {
            "type": "boolean"
          }
        }
      },
      "ModifyRepositoryAction": {
        "type": "object",
        "properties": {
          "repositoryId": {
            "type": "integer"
          },
          "action": {
            "type": "string",
            "enum": [
              "add",
              "remove"
            ]
          }
        }
      },
      "NotifyHistory": {
        "properties": {
          "id": {
            "type": "integer",
            "description": "在请求体中无效"
          },
          "type": {
            "type": "string",
            "enum": [
              "email",
              "sms",
              "wechat"
            ]
          },
          "title": {
            "type": "string"
          },
          "content": {
            "type": "string"
          },
          "from": {
            "type": "string"
          },
          "to": {
            "type": "string"
          },
          "status": {
            "type": "string"
          }
        }
      },
      "Organization": {
        "type": "object",
        "properties": {
          "id": {
            "type": "integer"
          },
          "name": {
            "type": "string"
          },
          "website": {
            "type": "string"
          },
          "orgToken": {
            "type": "string"
          }
        }
      },
      "Pipeline": {
        "type": "object",
        "properties": {
          "id": {
            "type": "integer",
            "description": "工作流ID",
            "example": 1
          },
          "name": {
            "type": "string",
            "description": "工作流名称",
            "example": "poetry-up-to-date"
          },
          "desc": {
            "type": "string",
            "description": "工作流描述",
            "example": "poetry 持续构建"
          },
          "env": {
            "$ref": "#/components/schemas/Env"
          },
          "stages": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/Stage"
            }
          },
          "supportRelease": {
            "type": "boolean",
            "description": "是否支持发布",
            "example": false
          }
        }
      },
      "PipelineListResponse": {
        "type": "array",
        "items": {
          "$ref": "#/components/schemas/Pipeline"
        }
      },
      "PipelineUpsertRequest": {
        "type": "object",
        "properties": {
          "name": {
            "type": "string",
            "description": "工作流名称",
            "example": "poetry-nightly"
          },
          "desc": {
            "type": "string",
            "description": "工作流描述",
            "example": "poetry持续发布"
          },
          "envId": {
            "type": "integer",
            "example": 1
          },
          "stages": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/StageUpdate"
            }
          },
          "supportRelease": {
            "type": "boolean",
            "description": "是否支持发布",
            "example": false
          }
        },
        "required": [
          "name",
          "desc",
          "envId",
          "stages",
          "supportRelease"
        ]
      },
      "Project": {
        "type": "object",
        "properties": {
          "id": {
            "type": "integer",
            "description": "产品唯一ID",
            "example": 1
          },
          "name": {
            "type": "string",
            "description": "产品名称",
            "example": "poetry"
          },
          "desc": {
            "type": "string",
            "description": "产品描述",
            "example": "poetry 产品线"
          },
          "teams": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/TeamLite"
            },
            "example": [
              {
                "id": 1,
                "name": "Poetry开发组"
              }
            ]
          },
          "releaser": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/UserLite"
            },
            "example": [
              {
                "id": 2,
                "name": "Alex"
              },
              {
                "id": 3,
                "name": "Bob"
              }
            ]
          }
        }
      },
      "ProjectListResponse": {
        "type": "array",
        "items": {
          "$ref": "#/components/schemas/Project"
        }
      },
      "ProjectUpsertRequest": {
        "type": "object",
        "properties": {
          "name": {
            "type": "string",
            "description": "产品名称",
            "example": "poetry"
          },
          "desc": {
            "type": "string",
            "description": "产品描述",
            "example": "poetry 产品"
          },
          "teams": {
            "type": "array",
            "items": {
              "type": "integer"
            },
            "example": [
              1,
              2
            ]
          },
          "releaser": {
            "type": "array",
            "items": {
              "type": "integer"
            },
            "description": "发布专员",
            "example": [
              1,
              2
            ]
          }
        },
        "required": [
          "name",
          "teams"
        ]
      },
      "ProjectVar": {
        "type": "object",
        "description": "产品全局变量",
        "properties": {
          "key": {
            "type": "string",
            "description": "变量名称 [a-z0-9A-Z_\\.\\-]+",
            "example": "MYSQL_ADDR"
          },
          "defaultValue": {
            "type": "string",
            "description": "变量默认值",
            "example": "mysql://mysql:3306/mysql"
          },
          "secured": {
            "type": "boolean",
            "description": "是否加密",
            "example": false
          }
        }
      },
      "ProjectVarList": {
        "type": "array",
        "description": "更新产品全局变量请求(全量)",
        "items": {
          "$ref": "#/components/schemas/ProjectVar"
        }
      },
      "QualityGate": {
        "type": "object",
        "properties": {
          "codeScan": {
            "type": "boolean"
          },
          "shouldReport": {
            "type": "boolean"
          },
          "rules": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/QualityGateRule"
            }
          }
        }
      },
      "QualityGateRule": {
        "type": "object",
        "properties": {
          "id": {
            "type": "integer"
          },
          "name": {
            "type": "string",
            "enum": [
              "CCT",
              "CCBTL"
            ]
          },
          "intValue": {
            "type": "integer"
          }
        }
      },
      "RepoMeasure": {
        "type": "object",
        "properties": {
          "repo": {
            "$ref": "#/components/schemas/Repository"
          },
          "measures": {
            "$ref": "#/components/schemas/Measure"
          }
        }
      },
      "RepoQualityGate": {
        "type": "object",
        "properties": {
          "detail": {
            "$ref": "#/components/schemas/QualityGate"
          },
          "repo": {
            "type": "object",
            "properties": {
              "id": {
                "type": "integer"
              },
              "name": {
                "type": "string"
              }
            }
          }
        }
      },
      "Repository": {
        "type": "object",
        "properties": {
          "id": {
            "type": "integer"
          },
          "name": {
            "type": "string"
          },
          "namespace": {
            "type": "string"
          },
          "mainBranch": {
            "type": "string"
          },
          "branches": {
            "type": "array",
            "items": {
              "type": "string"
            }
          },
          "codehostId": {
            "type": "integer"
          },
          "url": {
            "type": "string"
          },
          "team": {
            "$ref": "#/components/schemas/Team"
          },
          "withStats": {
            "type": "boolean",
            "description": "是否有CI数据"
          },
          "ciBranch": {
            "type": "string",
            "description": "CI数据上报分支"
          },
          "codehost": {
            "type": "object",
            "properties": {
              "id": {
                "type": "integer"
              },
              "name": {
                "type": "string"
              }
            }
          }
        }
      },
      "SecurityMeasureCount": {
        "type": "object",
        "properties": {
          "id": {
            "type": "integer"
          },
          "count": {
            "type": "integer"
          },
          "category": {
            "type": "string",
            "enum": [
              "owasp-a1",
              "owasp-a2",
              "owasp-a3",
              "owasp-a4",
              "owasp-a5",
              "owasp-a6",
              "owasp-a7",
              "owasp-a8",
              "owasp-a9",
              "owasp-a10"
            ]
          }
        }
      },
      "SecurityMeasureDetail": {
        "type": "object",
        "properties": {
          "detail": {
            "type": "object",
            "properties": {
              "line": {
                "type": "integer"
              },
              "file": {
                "type": "string"
              },
              "detail": {
                "type": "string"
              }
            }
          },
          "category": {
            "type": "string"
          }
        }
      },
      "SecurityReport": {
        "type": "object",
        "properties": {
          "count": {
            "type": "integer"
          },
          "time": {
            "type": "string"
          },
          "id": {
            "type": "integer"
          }
        }
      },
      "Service": {
        "type": "object",
        "properties": {
          "id": {
            "type": "integer",
            "description": "服务ID",
            "readOnly": true,
            "example": 1
          },
          "name": {
            "type": "string",
            "description": "服务名称",
            "example": "poetry-doc"
          },
          "desc": {
            "type": "string",
            "description": "服务名称",
            "example": "poetry-doc 服务"
          }
        },
        "required": [
          "id",
          "name"
        ]
      },
      "ServiceConf": {
        "allOf": [
          {
            "$ref": "#/components/schemas/ServiceConfLite"
          },
          {
            "type": "object",
            "properties": {
              "content": {
                "type": "string",
                "description": "服务配置模板内容",
                "example": "language=zh_cn\ntimezone=shanghai\n"
              }
            }
          }
        ]
      },
      "ServiceConfList": {
        "type": "array",
        "items": {
          "$ref": "#/components/schemas/ServiceConf"
        }
      },
      "ServiceConfListLite": {
        "type": "array",
        "items": {
          "$ref": "#/components/schemas/ServiceConfLite"
        }
      },
      "ServiceConfLite": {
        "type": "object",
        "properties": {
          "name": {
            "type": "string",
            "description": "配置名称",
            "pattern": "[a-z0-9A-Z-_\\.]+",
            "example": "lan.properties"
          },
          "language": {
            "type": "string",
            "description": "配置语言如yaml,plain,properties,ini",
            "example": "properties"
          },
          "type": {
            "type": "string",
            "enum": [
              "spec",
              "conf"
            ],
            "example": "spec",
            "description": "配置类型，spec是k8syaml文件，conf是普通配置文件"
          }
        }
      },
      "ServiceConfRevision": {
        "type": "object",
        "properties": {
          "id": {
            "type": "integer",
            "example": 1
          },
          "created": {
            "type": "string",
            "description": "创建时间",
            "example": "2019-01-01T00:00:00.000Z"
          },
          "createdBy": {
            "type": "string",
            "description": "创建者",
            "example": "bob",
            "readOnly": true
          },
          "confs": {
            "$ref": "#/components/schemas/ServiceConfList"
          }
        }
      },
      "ServiceConfRevisionList": {
        "type": "array",
        "items": {
          "$ref": "#/components/schemas/ServiceConfRevisionLite"
        }
      },
      "ServiceConfRevisionLite": {
        "type": "object",
        "properties": {
          "id": {
            "type": "integer",
            "example": 1
          },
          "created": {
            "type": "string",
            "description": "创建时间",
            "example": "2019-01-01T00:00:00.000Z"
          },
          "confs": {
            "$ref": "#/components/schemas/ServiceConfListLite"
          }
        }
      },
      "ServiceList": {
        "type": "array",
        "items": {
          "$ref": "#/components/schemas/Service"
        }
      },
      "ServiceWithConf": {
        "allOf": [
          {
            "$ref": "#/components/schemas/Service"
          },
          {
            "type": "object",
            "properties": {
              "conf": {
                "$ref": "#/components/schemas/ServiceConfRevision"
              }
            }
          }
        ],
        "required": [
          "id",
          "name",
          "conf"
        ]
      },
      "ServiceWithConfLite": {
        "allOf": [
          {
            "$ref": "#/components/schemas/Service"
          },
          {
            "type": "object",
            "properties": {
              "conf": {
                "$ref": "#/components/schemas/ServiceConfRevisionLite"
              }
            }
          }
        ],
        "required": [
          "id",
          "name",
          "conf"
        ]
      },
      "Stage": {
        "type": "object",
        "properties": {
          "name": {
            "type": "string",
            "description": "步骤名称",
            "example": "poetry构建"
          },
          "jobs": {
            "type": "array",
            "description": "任务列表",
            "items": {
              "$ref": "#/components/schemas/Job"
            },
            "example": [
              1,
              2
            ]
          }
        }
      },
      "StageUpdate": {
        "type": "object",
        "properties": {
          "name": {
            "type": "string",
            "description": "步骤名称",
            "example": "构建"
          },
          "jobs": {
            "type": "array",
            "description": "任务列表",
            "items": {
              "type": "integer"
            },
            "example": [
              1,
              2
            ]
          }
        },
        "required": [
          "name",
          "jobs"
        ]
      },
      "Team": {
        "type": "object",
        "properties": {
          "id": {
            "type": "integer"
          },
          "name": {
            "type": "string"
          },
          "leaders": {
            "type": "array",
            "items": {
              "type": "object",
              "properties": {
                "id": {
                  "type": "integer"
                },
                "name": {
                  "type": "string"
                }
              }
            }
          },
          "desc": {
            "type": "string"
          },
          "orgId": {
            "type": "integer"
          }
        }
      },
      "TeamLite": {
        "type": "object",
        "properties": {
          "id": {
            "type": "integer"
          },
          "name": {
            "type": "string"
          }
        }
      },
      "TeamMeasure": {
        "type": "object",
        "properties": {
          "team": {
            "$ref": "#/components/schemas/Team"
          },
          "measures": {
            "$ref": "#/components/schemas/Measure"
          }
        }
      },
      "TeamQualityGate": {
        "type": "object",
        "properties": {
          "detail": {
            "$ref": "#/components/schemas/QualityGate"
          },
          "repos": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/RepoQualityGate"
            }
          }
        }
      },
      "User": {
        "type": "object",
        "properties": {
          "id": {
            "type": "integer"
          },
          "name": {
            "type": "string"
          },
          "email": {
            "type": "string"
          },
          "phone": {
            "type": "string"
          },
          "isAdmin": {
            "type": "boolean",
            "description": "是否组织管理员"
          },
          "isSuperUser": {
            "type": "boolean"
          },
          "isTeamLeader": {
            "type": "boolean",
            "description": "仅当根据teamId搜索时有意义"
          },
          "teams": {
            "type": "array",
            "items": {
              "type": "object",
              "properties": {
                "id": {
                  "type": "integer"
                },
                "name": {
                  "type": "string"
                }
              }
            }
          },
          "lastLogin": {
            "type": "integer"
          },
          "directory": {
            "type": "string",
            "description": "可以是 system 或者 AD的名称"
          }
        }
      },
      "UserLite": {
        "type": "object",
        "properties": {
          "id": {
            "type": "integer"
          },
          "name": {
            "type": "string"
          }
        }
      }
    },
    "parameters": {
      "page": {
        "name": "page",
        "in": "query",
        "description": "分页index",
        "schema": {
          "type": "integer"
        }
      },
      "per_page": {
        "name": "per_page",
        "in": "query",
        "description": "分页大小",
        "schema": {
          "type": "integer"
        }
      }
    },
    "headers": {
      "X-Total": {
        "description": "总数",
        "schema": {
          "type": "integer"
        }
      }
    },
    "securitySchemes": {
      "ApiKeyAuth": {
        "type": "apiKey",
        "in": "header",
        "name": "X-API-KEY",
        "description": "普通用户使用的API-KEY, [a-zA-Z0-9]{16}"
      },
      "ApiOrgTokenAuth": {
        "type": "apiKey",
        "in": "header",
        "name": "X-ORG-TOKEN",
        "description": "企业TOKEN, [a-zA-Z0-9]{16}"
      },
      "ApiRootKeyAuth": {
        "type": "apiKey",
        "in": "header",
        "name": "X-ROOT-API-KEY",
        "description": "root权限使用的API-KEY, [a-zA-Z0-9]{16}"
      }
    }
  }
}
